# tatemono-map WBS（工程管理表）

> このドキュメントは、tatemono-map プロジェクトの
> **設計思想・実装順・完了条件を固定するための工程表（WBS）** である。
> 実装の自由度は認めるが、この順序と制約は変更しない。

---

## Phase 0：思想・仕様・運用の固定（ブレ防止）

### 目的（Why）

* 実装前に「何を作らないか」を明確にし、暴走を防ぐ
* 人が変わっても判断基準が変わらない状態を作る

### やること（What）

* プロジェクト憲法の明文化
* 既存ドキュメントの役割分担を確定
* WBS を正本として確定

### 完了条件（DoD）

* docs/spec.md が仕様の正本として成立している
* docs/data_contract.md が取得・正規化ルールを定義している
* docs/runbook.md が運用ルールを定義している
* 本 docs/wbs.md が存在し、全体工程が一望できる

### 参照

* spec.md
* data_contract.md
* runbook.md

---

## Phase 1：API / DB の最小構成（PoC）

### 目的（Why）

* 「動く最小単位」を作り、机上設計で終わらせない
* 将来拡張ではなく、今の判断材料を得る

### やること（What）

* SQLite DB の導入
* 建物サマリーの最小テーブル設計
* FastAPI から DB を参照できる状態を作る

### 完了条件（DoD）

* DB に建物データを保存できる
* `/health` が正常応答する
* `/b/{building_key}` が DB を参照する
* データが無くても API が落ちない

### 制約

* 号室・参照元URL・管理会社情報は Web 出力禁止
* 空室ステータスは 2 値のみ

### 参照

* spec.md
* data_contract.md

---

## Phase 2：静的HTML生成（SEO土台）

### 目的（Why）

* API を直接叩かせず、Web は「図鑑」として完結させる
* LINE 誘導の母艦を作る

### やること（What）

* 静的 HTML 生成 CLI の実装
* index ページと建物ページの生成
* テンプレートの固定

### 完了条件（DoD）

* dist/index.html が生成される
* dist/b/{building_key}.html が生成される
* Web 上に出してはいけない情報が一切含まれない
* 最終更新日時が必ず表示される

### 参照

* spec.md

---

## Phase 3：更新運用の証明（週2回更新）

### 目的（Why）

* 「運用できるか」を技術で証明する
* 手動運用に耐えない設計を排除する

### やること（What）

* ingest スクリプトの段階的実装
* Phase 1：スタブデータで upsert
* Phase 2：Gmail からの実データ取得（後回し可）

### 完了条件（DoD）

* スクリプト実行で DB が更新される
* last_updated が正しく更新される
* 更新失敗時も Web / API が動き続ける

### 参照

* data_contract.md
* runbook.md

---

## Phase 4：LINE 誘導・管理者通知

### 目的（Why）

* Web を「刈り取り装置」にしない
* 失敗を検知できる状態にする

### やること（What）

* Web から LINE 公式アカウントへの導線固定
* 更新失敗時の管理者通知設計

### 完了条件（DoD）

* Web 申込完結が存在しない
* LINE 未設定時はログで代替される
* 通知失敗でもサービスは停止しない

### 参照

* spec.md
* runbook.md

---

## Phase 5：拡張余地（今はやらない）

### 目的（Why）

* 将来やる可能性を否定しない
* 今やらない理由を明文化する

### やらないこと（明示）

* 本番 VPS 配置
* 認証・ログイン機能
* 号室単位の詳細公開
* 見積・PDF ダウンロード
* 管理会社向け管理画面

### 完了条件（DoD）

* 「やらない理由」がドキュメントに残っている

---

## 全体ルール（重要）

* フェーズは順番に進める
* 次フェーズに進む条件は DoD の達成のみ
* 途中で仕様を足さない
* 迷ったら spec.md と wbs.md に戻る

---
